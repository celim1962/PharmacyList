<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google" content="notranslate">
    <title>Pharmacy List</title>
    <style>
        input {
            width: 50vw;
            height: 10vh;
        }
        .display {
            font-size: 3rem;
        }
    </style>
</head>
<body>
    <h1>Pharmacy List</h1>
    <label>藥名:</label><input type="text" id="input" list="drugs" />
    <datalist id="drugs">
    </datalist>
    <h2 id="result" class="display">Area:</h2>

    <input type="button" id="readText" value="readText" hidden>
    <p id="textRes"></p>

    <script type="text/javascript">

        let target = document.getElementById('input');
        let result = document.getElementById('result');
        let drugs = document.getElementById('drugs');
        let resource = {};

        let readText = document.getElementById('readText');
        readText.addEventListener('click', async () => {
            let content = await fetch('./resource.txt');
            let texts = await content.text();
            let resources = texts.split(',');
            resources.map(item => item = item.replace(/(?:\\[rn])+/g, ""));

            for (let index in resources) {
                let temp = resources[index].split(':');
                temp[0] = temp[0].replace('\r\n', '').replaceAll('\'', '');
                temp[1] = temp[1].replace('\r\n', '').replaceAll('\'', '').trim();
                resource[temp[0]] = temp[1];
            }

            for (let i in resource) {
                let option = document.createElement('option');
                option.value = i;
                drugs.appendChild(option)
            }

            target.addEventListener('keyup', () => {
                result.innerText = `Area: ${resource[target.value]}`;
            })

        })

        readText.click();
    </script>
</body>
</html>